<!DOCTYPE html>
<html lang="ja">
  <head>
      <meta charset="utf-8">
      <!-- スマホで見やすくする設定 -->
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <link rel="stylesheet" type="text/css" href="post_stylesheet.css">
      
      <!-- ブラウザのタブに表示されるタイトル -->
      <title>投稿画面</title>
      <!--<button type="button" onclick="history.back()"><h3>戻る</h3></button>-->
  </head>
<header>
  <ul id="login_logout" class="mypage-post-tab">
    <!--<li class="js-mypage-tab-me">-->
    <!--    <img src="img/icon/dis.png" class="mypage-tab-img">-->
    <!--  </li>-->
    </ul>
</header>
  <body>
      <br/><br/><br/>
      <form action="/instaglam/api/upload_post_db.php" method="post" enctype="multipart/form-data">
        <div>
          <label for="title">Title:</label>
          <input type="title" id="title" name="title">
        </div>
        <input type="file" name="upload_file" id="upload_file" class="data file" />
        <br /><br />
        <span id="preview_area">
          <img id='preview' width= auto height="220" src="img/icon/JPG.png" >
          </div>
        </span> 
        <br /><br />
        <div>
          <label for="description">Description:</label>
          <textarea id="description" name="description"></textarea>
        </div>
        <div>
          <label for="price">Price:</label>
          <input type="price" id="price" name="price">
        </div>
        <input type="radio" name="category_id" value="2">レジャー
        <input type="radio" name="category_id" value="1">店舗
        <input type="hidden" id="lat" name="lat">
        <input type="hidden" id="lon" name="lon">
        <br /><br />
        <input type="submit" value="送信" />
        <br /><br />
      </form>
      
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
      
      <script>
        $.urlParam = function(name){
            var results = new RegExp('[\?&]' + name + '=([^&#]*)').exec(window.location.href);
            if (results==null){
               return null;
            }
            else{
               return decodeURI(results[1]) || 0;
            }
        }
        var lat = $.urlParam('lat');
        var lon = $.urlParam('lon');
        $('#lat').val(lat);
        $('#lon').val(lon);
        
        var list = "<li>\
                          <a  href='/instaglam/list_screen.html?lon=" + lon + "&lat=" + lat + "'><img src='img/icon/aim.png' class='mypage-tab-img'></a>\
                          </li>";
        $("#login_logout").append(list);
        
        
        if (document.cookie.match(/user_id=/)){
            // console.log("logout")
            var post = "<li>\
                         <a  href='/instaglam/post_screen.html?lon=" + lon + "&lat=" + lat + "'>POST</a>\
                         </li>";
                    $("#login_logout").append(post);
            
            var my = "<li>\
                         <a  href='/instaglam/my_screen.html?lon=" + lon + "&lat=" + lat + "'>MY PAGE</a>\
                         </li>";
                    $("#login_logout").append(my);
        }else{
                // console.log("login")
            var login = "<li>\
                             <a  href='/instaglam/login_screen.html?lon=" + lon + "&lat=" + lat + "'>LOGIN</a>\
                             </li>";
                        $("#login_logout").append(login);
        
    };
        
        $('#upload_file').on('change', function(){
          var strFileInfo = $('#upload_file')[0].files[0];
          if(strFileInfo && strFileInfo.type.match('image.*')){ 
      
            $('#preview').remove();
            $('#preview_area').append('<img id="preview" width= auto height="220" />'); 
      
            fileReader = new FileReader(); 
            fileReader.onload = function(event){
              $('#preview').attr('src', event.target.result);
            }
      
            fileReader.readAsDataURL(strFileInfo); 
          }
        });
      </script>
  </body>
<html>